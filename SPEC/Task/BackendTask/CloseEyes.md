# 闭眼检测详细实现
1. 功能简述
   该功能为本软件的重要功能，使用大模型分析图片，检测图片人物是否闭眼，以及图片质量的好坏。
2. 技术栈
   YOLOv10

3. 实现目标
   - 以参考图片为准，记录下参考图片中所有人物的人脸特征。
   - 使用大模型正确判断每一张图片中，参考人物的表情，包括是否闭眼，人脸是否有遮挡等特征。返回给前端正确的状态。
   - 如果参考人物闭眼，要判断这个闭眼的行为是正确的，还是错误的。

4. 功能特点
   引入大模型，让大模型推理出参考人物的眼部状态以及面部表情。判断图片是否是高质量表情图片。

5. 流程图
   用户点击"筛查"
    ↓
    弹出文件浏览器
    ↓
    选择参考人物图片
    ↓
    大模型记录参考人物图片的人脸特征
    ↓
    筛查当前文件夹中的其余图片
    ↓
    大模型识别当前图片中是否有参考人物
    ↓
    忽视参考人物之外的人脸，针对参考人物，进行表情检测，
    ↓
    若参考人物闭眼，则引入面部表情检测，推理人物是否微笑等其他表情
    ↓
    返回表情检测结果（闭眼，正常）


6. 注意事项
   参考人物可能有多个，需要记录参考图片中的每一个人脸。
   创建一个Agent.json, 记录置信度阈值和参考人脸特征数值。
   每次点击筛选并传入参考人物图片后，覆盖当前的参考人脸特征数值。
   使用YOLOv10的预训练模型，快速落地功能

7. 扩展
   YOLO对接gpt-4o，优化检测规则，针对闭眼检测的误检/漏检问题，给出YOLO模型微调的数据集标注建议。

8. 代码位置
   该功能的所有代码放在`D:\PictureFilter\Backend\Model`文件夹下